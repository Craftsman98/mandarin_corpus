<!DOCTYPE html>
<!-- saved from url=(0052) -->
<html lang="en" xmlns:th="http://www.thymeleaf.org">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<meta name="description" content="">
		<meta name="author" content="">

		<title>Excel表格</title>
		<!-- Bootstrap core CSS -->
		<link href="/asserts/css/bootstrap.min.css" rel="stylesheet">

		<!-- Custom styles for this template -->
		<link href="/asserts/css/dashboard.css" rel="stylesheet">
	</head>

	<body>
		<div th:replace="common/common :: navbar"></div>

		<div class="container-fluid">
			<div class="row">
				<div th:replace="common/common :: sidebar"></div>

				<main role="main" class="col-md-9 ml-sm-auto col-lg-10 pt-3 px-4">
					<h2> 导入Excel表格 </h2>
					<br>
					<p><strong>请注意，上传的文件支持.xls和.xlsx两种格式。</strong>建议下载模板文件后，将数据复制入模板文件中再进行上传。</p>
					<br>
					<p><strong>点击按钮下载各数据库模板文件</strong></p>
					<div class="custom-control-inline">
						<button class="btn btn-outline-primary" type="submit" id="inputGroupFileAddon05">下载模板</button>
					</div>
					<br><br>
					<form action="#" th:action="@{/excel/import}" enctype="multipart/form-data" method="post">
						<div class="input-group">
							<div>
								<select class="combobox custom-select" data-th-style="btn-primary" name="category">
									<option>选择需要导入的版块</option>
									<option value="zhonggu">中古近代音韵</option>
									<option value="yunshu">官话韵书韵图</option>
									<option value="hanwai">官话汉外译音</option>
								</select>
							</div>
							<div class="custom-file">
								<input onchange="showFilename(this.files[0])" name="file" type="file" class="custom-file-input"
									   id="inputGroupFile04" aria-describedby="inputGroupFileAddon04">
								<label id="filename_label" class="custom-file-label" for="inputGroupFile04">选择要上传的文件</label>
							</div>
							<div class="input-group-append">
								<button class="btn btn-outline-primary" type="submit" id="inputGroupFileAddon04">上传</button>
							</div>
						</div>
					</form>
					<br>
					<div class="alert alert-success alert-dismissible fade show" th:if="${msg} != null and ${success} == true">
						<button type="button" class="close" data-dismiss="alert">&times;</button>
						<strong> [[${msg}]] </strong>
<!--						<p th:text="${msg}" style="color: red;"></p>-->
					</div>

					<div class="alert alert-danger alert-dismissible fade show" th:if="${msg} != null and ${success} == false">
						<button type="button" class="close" data-dismiss="alert">&times;</button>
						<strong> [[${msg}]] </strong>
						<!--						<p th:text="${msg}" style="color: red;"></p>-->
					</div>

					<br>
					<br>
					<br>
					<h5 class="font-weight-bold">注意：</h5>
					<br>
					<p> 1. 只能导入Excel格式文件（后缀名为.xls或.xlsx）。</p>
					<p> 2. 请保持Excel第一行表头与模板中的表头<strong>名称一致</strong>（顺序可颠倒）。</p>
					<p> 3. 如果Excel文件中存在与数据库中相同<strong>编号</strong>的数据，将会更新这条数据。</p>
					<p> 4. 文件导入过程可能持续几分钟，期间请耐心等待，不要进行其他操作。</p>

				</main>
			</div>
		</div>

		<!-- Bootstrap core JavaScript
    ================================================== -->
		<!-- Placed at the end of the document so the pages load faster -->
		<script type="text/javascript" src="/asserts/js/jquery-3.2.1.slim.min.js" ></script>
		<script type="text/javascript" src="/asserts/js/bootstrap.min.js" ></script>

		<!-- 显示文件名 -->
		<script>
			function showFilename(file){
				$("#filename_label").html(file.name);
			}

			$(document).ready(function(){
				$('.combobox').combobox();
			});
		</script>
	</body>

</html>